<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SmartBite - Filter Recipes</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/styles.css') }}">
</head>
<body class="body-home">
    {% include 'navbar_logged_in.html' %}

    <h2 class="text-center mt-5" style="font-size: 2.5rem; font-weight: 700;"> Customize Your Meal – Filter Recipes by Ingredients.</h2>
    <p class="text-center" style="font-size: 1.3rem;"> Select the ingredients you have or prefer, and we'll show you recipes you can make right now! </p>
    <div class="container mt-5">
        <h2>Search For Recipes</h2>
        
        <!-- Form to input tags -->
        <form id="tagForm" action="{{ url_for('browse_recipes') }}" method="POST">
            <div class="col-md-5">
                <label for="tagsInput">Enter tags (comma separated)</label>
                <input type="text" class="form-control" id="tagsInput" name="tagsInput" placeholder="e.g: tomato, fish, milk">
            </div>
            <button type="button" class="btn btn-primary mt-2" id="addTagsButton" style="background-color: #1b0b5a; border-color:#1b0b5a;">Add Tags</button>
            
            <h4 class="mt-4" style="color: white;">Tags:</h4>
            <div id="tagContainer"></div>
            
            <!-- Hidden input to send the final tags -->
            <input type="hidden" id="finalTags" name="finalTags">

            <!-- Submit button -->
            <button type="submit" class="btn btn-success mt-3">Submit Tags</button>
        </form>
    
      </div>
    
      <!-- Bootstrap JS and jQuery -->
      <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"></script>
      <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.5.3/dist/umd/popper.min.js"></script>
      <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
    
      <script>
        const tagForm = document.getElementById('tagForm');
        const tagInput = document.getElementById('tagsInput');
        const tagContainer = document.getElementById('tagContainer');
        const finalTagsInput = document.getElementById('finalTags');
        const addTagsButton = document.getElementById('addTagsButton');

        addTagsButton.addEventListener('click', function(event) {
          // Get tags from input and split by commas
          const tags = tagInput.value.split(',').map(tag => tag.trim()).filter(tag => tag.length > 0);
    
          // Clear input field
          tagInput.value = '';
    
          // Add each tag as a badge
          tags.forEach(tag => {
            const tagElement = document.createElement('div');
            tagElement.classList.add('tag', 'badge', 'bg-primary', 'm-1');
            tagElement.innerHTML = `${tag} <span class="close" onclick="removeTag(this)" style="cursor: pointer;">&times;</span>`;
            tagContainer.appendChild(tagElement);
          });

          updateFinalTags();
        });

        // Function to update the hidden input field with all tags
        function updateFinalTags() {
          const tags = Array.from(tagContainer.children).map(tagElement => {
            return tagElement.textContent.replace('×', '').trim();
          });
          finalTagsInput.value = tags.join(',');
        }

        // Function to remove a tag
        function removeTag(element) {
          const tagElement = element.parentElement;
          tagContainer.removeChild(tagElement);
          updateFinalTags();
        }
      </script>
</body>
</html>
